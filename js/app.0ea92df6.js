(function(){"use strict";var e={4094:function(e,a,t){var s=t(5130),l=t(6768),n=t(4232),o=t(144),r=t(782);t(8111),t(116);const u={class:"select-command"};var i=(0,l.pM)({__name:"selectCommandType",setup(e){const a=(0,r.Pj)(),t=(0,l.EW)({get:()=>a.state.steps.stepsFields.isAlone,set:e=>{a.state.steps.stepsFields.isAlone=e,a.state.steps.stepsFields.isAlone&&(a.state.steps.stepsFields.isAlone=!1,setTimeout((()=>{a.state.steps.stepsFields.isAlone=!0}),100)),a.state.steps.stepsFields.selectedStages=[],a.state.steps.stepsFields.yachtType=null}});return(e,a)=>((0,l.uX)(),(0,l.CE)("div",u,[(0,l.Lk)("button",{class:(0,n.C4)(["big-btn",{_active:!1===t.value}]),onClick:a[0]||(a[0]=e=>t.value=!1)}," У меня команда ",2),(0,l.Lk)("button",{class:(0,n.C4)(["big-btn",{_active:!0===t.value}]),onClick:a[1]||(a[1]=e=>t.value=!0)}," Я один ",2)]))}}),c=t(1241);const d=(0,c.A)(i,[["__scopeId","data-v-3fd06b70"]]);var m=d;const p={class:"custom-radio"},v=["id","name","value","checked","aria-checked","disabled"],f=["for"],b={class:"radio-label"};var h=(0,l.pM)({__name:"radio-input",props:{modelValue:{},value:{},name:{},id:{},disabled:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:a}){const t=e,s=a,n=(0,l.EW)((()=>t.modelValue===t.value)),o=()=>{s("update:modelValue",t.value),s("updateValue",n)};return(e,a)=>((0,l.uX)(),(0,l.CE)("div",p,[(0,l.Lk)("input",{type:"radio",id:e.id,name:e.name,value:e.value,checked:n.value,onChange:o,"aria-checked":n.value,disabled:e.disabled,role:"radio"},null,40,v),(0,l.Lk)("label",{for:e.id},[a[0]||(a[0]=(0,l.Lk)("span",{class:"radio-button","aria-hidden":"true"},null,-1)),(0,l.Lk)("span",b,[(0,l.RG)(e.$slots,"default")])],8,f)]))}});const _=(0,c.A)(h,[["__scopeId","data-v-e38723e2"]]);var k=_;const y={key:0,class:"select-yacht"},g={class:"select-yacht__row"},L={key:0,class:"select-yacht__row"};var E=(0,l.pM)({__name:"selectYachtType",setup(e){const a=(0,r.Pj)(),t=(0,l.EW)((()=>a.state.staffsPositions)),s=(0,o.KR)(null),u=(0,l.EW)((()=>a.state.steps.stepsFields)),i=(0,l.EW)((()=>a.state.selectedEvent)),c=(0,l.EW)((()=>Object.keys(i.value.newTeam)));function d(e){return c.value.includes(e.position)}const m=(0,l.EW)({get:()=>u.value.yachtType,set:e=>{u.value.yachtType=e,u.value.yachtType=null,setTimeout((()=>{u.value.yachtType=e}),100),a.state.steps.stepsFields.selectedStages=[]}});return(0,l.wB)(s,(e=>{m.value=e?"":t.value[0]})),(e,a)=>t.value.length>0?((0,l.uX)(),(0,l.CE)("div",y,[(0,l.Lk)("div",g,[(0,l.bF)(k,{disabled:!d(t.value[0]),name:"yachtType1",id:"yachtType123",value:!1,onUpdateValue:a[0]||(a[0]=e=>s.value=!1)},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(t.value[0].btnText),1)])),_:1},8,["disabled"]),(0,l.bF)(k,{name:"yachtType1",id:"yachtTypee347",value:!0,modelValue:s.value,"onUpdate:modelValue":a[1]||(a[1]=e=>s.value=e),disabled:!d(t.value[1])&&!d(t.value[2])},{default:(0,l.k6)((()=>a[4]||(a[4]=[(0,l.eW)("Своя яхта")]))),_:1},8,["modelValue","disabled"])]),s.value?((0,l.uX)(),(0,l.CE)("div",L,[(0,l.bF)(k,{disabled:!d(t.value[1]),name:"yachtType2",id:"yachtType3465",value:t.value[1],modelValue:m.value,"onUpdate:modelValue":a[2]||(a[2]=e=>m.value=e)},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(t.value[1].btnText),1)])),_:1},8,["disabled","value","modelValue"]),(0,l.bF)(k,{disabled:!d(t.value[2]),name:"yachtType2",id:"yachtType986",value:t.value[2],modelValue:m.value,"onUpdate:modelValue":a[3]||(a[3]=e=>m.value=e)},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(t.value[2].btnText),1)])),_:1},8,["disabled","value","modelValue"])])):(0,l.Q3)("",!0)])):(0,l.Q3)("",!0)}});const T=(0,c.A)(E,[["__scopeId","data-v-56d5d5da"]]);var w=T;t(4114),t(7588);const F={class:"custom-checkbox"},O=["id","name","value","checked","disabled"],W=["for"],C={class:"checkbox-label"};var V=(0,l.pM)({__name:"check-input",props:{modelValue:Boolean,value:String,name:String,id:String,disabled:Boolean},emits:["update:modelValue"],setup(e,{emit:a}){const t=e,s=a,n=(0,l.EW)((()=>t.modelValue)),o=()=>{s("update:modelValue",!t.modelValue),s("updateValue",!t.modelValue)};return(a,t)=>((0,l.uX)(),(0,l.CE)("div",F,[(0,l.Lk)("input",{type:"checkbox",id:e.id,name:e.name,value:e.value,checked:n.value,onChange:o,disabled:e.disabled,role:"checkbox"},null,40,O),(0,l.Lk)("label",{for:e.id},[t[0]||(t[0]=(0,l.Lk)("span",{class:"checkbox-box","aria-hidden":"true"},null,-1)),(0,l.Lk)("span",C,[(0,l.RG)(a.$slots,"default")])],8,W)]))}});const N=(0,c.A)(V,[["__scopeId","data-v-33effa00"]]);var S=N;function x(e){const a=["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],t=new Date(e),s=t.getDate(),l=a[t.getMonth()];return`${s} ${l}`}const A={class:"select-command"},B={key:0},$={key:1,class:"_invalid-text"};var I=(0,l.pM)({__name:"selectStages",setup(e){const a=(0,r.Pj)(),t=(0,o.Kh)([!1,!1,!1,!1,!1,!1,!1]),s=(0,l.EW)((()=>a.state.selectedEvent)),u=(0,l.EW)((()=>a.state.steps.stepsFields)),i=(0,l.EW)((()=>u.value.isAlone)),c=(0,l.EW)((()=>u.value.yachtType));function d(e,a){if(v(e))return e.name;if(1===a){const a=e.name,t=x(e.services[0].date);return`${a} — ${t}`}if(2===a){const a=e.name2,t=x(e.services2[0].date);return`${a} — ${t}`}}const m=(0,l.EW)((()=>{let e;return e=i.value?s.value.existingTeam:s.value.newTeam[c.value.position],e.sort(((e,a)=>e.number-a.number))}));function p(e,t){if(v(t))return;console.log(e);const s=a.state.steps.stepsFields.selectedStages;if(e)s.push(t);else{const e=t.number,a=s.findIndex((a=>a.number===e));s.splice(a,1)}}function v(e){return 0===e.services.length}function f(e){let a=!0;return e.services.forEach((e=>{e.records_count===e.capacity&&(a=!1)})),a}return(0,l.hi)((()=>{a.state.steps.stepsFields.selectedStages=[]})),(e,a)=>((0,l.uX)(),(0,l.CE)("div",A,[a[1]||(a[1]=(0,l.Lk)("h2",{class:"tit-h2"},"Отметьте этапы участия (можно несколько):",-1)),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(m.value,((e,s)=>((0,l.uX)(),(0,l.Wv)(S,{value:!1,modelValue:t[s],"onUpdate:modelValue":e=>t[s]=e,id:`selectStage${e.number}`,key:e.number,onUpdateValue:a=>p(a,e),disabled:v(e),class:(0,n.C4)({"_invalid-text":!f(e)})},{default:(0,l.k6)((()=>[(0,l.Lk)("p",null,(0,n.v_)(d(e,1)),1),e.name2?((0,l.uX)(),(0,l.CE)("p",B,(0,n.v_)(d(e,2)),1)):(0,l.Q3)("",!0),f(e)?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("p",$,a[0]||(a[0]=[(0,l.eW)("Мест нет, но мы можем добавить вас в "),(0,l.Lk)("span",{class:"fw-700"},"лист ожидания",-1)])))])),_:2},1032,["modelValue","onUpdate:modelValue","id","onUpdateValue","disabled","class"])))),128))]))}});const X=(0,c.A)(I,[["__scopeId","data-v-ee95b88e"]]);var j=X;const P={class:"select-instructor"},M={class:"select-instructor__row"},D={key:0};var U=(0,l.pM)({__name:"selectInstructor",setup(e){const a=(0,r.Pj)(),t=(0,o.KR)(null);return(0,l.wB)(t,(()=>{a.state.steps.stepsFields.instructor="on"===t.value})),(0,l.hi)((()=>{a.state.steps.stepsFields.instructor=null,a.state.steps.stepsFields.comment=""})),(e,n)=>((0,l.uX)(),(0,l.CE)("div",P,[(0,l.Lk)("div",M,[(0,l.bF)(k,{name:"selectInstructor",id:"selectInstructor1",value:"on",modelValue:t.value,"onUpdate:modelValue":n[0]||(n[0]=e=>t.value=e)},{default:(0,l.k6)((()=>n[3]||(n[3]=[(0,l.eW)("С инструктором")]))),_:1},8,["modelValue"]),(0,l.bF)(k,{name:"selectInstructor",id:"selectInstructor2",value:"off",modelValue:t.value,"onUpdate:modelValue":n[1]||(n[1]=e=>t.value=e)},{default:(0,l.k6)((()=>n[4]||(n[4]=[(0,l.eW)("Без инструктора")]))),_:1},8,["modelValue"])]),"on"===t.value?((0,l.uX)(),(0,l.CE)("div",D,[n[5]||(n[5]=(0,l.Lk)("label",{class:"label-title",for:"texarea47653"},"Комментарий:",-1)),(0,l.bo)((0,l.Lk)("textarea",{"onUpdate:modelValue":n[2]||(n[2]=e=>(0,o.R1)(a).state.steps.stepsFields.comment=e),placeholder:"Есть любимый инструктор? Укажите имя — постараемся его назначить",class:"default-textarea",id:"texarea47653"},null,512),[[s.Jo,(0,o.R1)(a).state.steps.stepsFields.comment]])])):(0,l.Q3)("",!0)]))}});const R=(0,c.A)(U,[["__scopeId","data-v-92cea390"]]);var Q=R;t(1148);const q={class:"member-form__item"},G={class:"member-form__item"},K={key:0,class:"member-form__item"},J=["required"],z={class:"member-form__item"},Y={class:"member-form__item"},H={class:"member-form__item"},Z=["disabled"];var ee=(0,l.pM)({__name:"memberDataForm",setup(e){const a=(0,r.Pj)(),t=(0,l.EW)((()=>a.state.steps.stepsFields)),u=(0,l.EW)((()=>a.state.steps.memberForm)),i=(0,l.EW)((()=>t.value.isAlone)),c=(0,o.Kh)({email:!0,phone:!0,teamName:!0,name:!0,lastName:!0,dateBorn:!0});function d(e){switch(e){case"email":{const e=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;c.email=e.test(u.value.email);break}case"phone":c.phone=!!u.value.phone;break;case"teamName":c.teamName=i.value||!!u.value.teamName;break;case"name":c.name=u.value.name.length>=2;break;case"lastName":c.lastName=u.value.lastName.length>=2;break;case"dateBorn":{const e=(new Date).toISOString().split("T")[0];c.dateBorn=u.value.dateBorn&&u.value.dateBorn<=e;break}}}function m(){d("email"),d("phone"),d("teamName"),d("name"),d("lastName"),d("dateBorn");const e=Object.values(c).every(Boolean);e&&p()}function p(){console.log("Форма успешно валидирована и готова к отправке!"),a.dispatch("createOrders")}const v=(0,l.EW)((()=>a.state.steps.createdOrdersLoading));return(e,a)=>((0,l.uX)(),(0,l.CE)("form",{class:"member-form",onSubmit:a[12]||(a[12]=(0,s.D$)((()=>{}),["prevent"]))},[(0,l.Lk)("fieldset",null,[a[19]||(a[19]=(0,l.Lk)("legend",{class:"tit-h2"},"Данные капитана:",-1)),(0,l.Lk)("div",q,[a[13]||(a[13]=(0,l.Lk)("label",{for:"email",class:"label-title"},"Email:",-1)),(0,l.bo)((0,l.Lk)("input",{type:"email",id:"email",class:(0,n.C4)(["default-input",{_invalid:!c.email}]),placeholder:"email","onUpdate:modelValue":a[0]||(a[0]=e=>u.value.email=e),required:"",onBlur:a[1]||(a[1]=e=>d("email"))},null,34),[[s.Jo,u.value.email]])]),(0,l.Lk)("div",G,[a[14]||(a[14]=(0,l.Lk)("label",{for:"phone",class:"label-title"},"Номер телефона:",-1)),(0,l.bo)((0,l.Lk)("input",{type:"tel",name:"phone",id:"phone",class:(0,n.C4)(["default-input",{_invalid:!c.phone}]),placeholder:"+7","onUpdate:modelValue":a[2]||(a[2]=e=>u.value.phone=e),required:"",onBlur:a[3]||(a[3]=e=>d("phone"))},null,34),[[s.Jo,u.value.phone,void 0,{number:!0}]])]),i.value?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",K,[a[15]||(a[15]=(0,l.Lk)("label",{for:"team-name",class:"label-title"},"Название команды:",-1)),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"team-name",class:(0,n.C4)(["default-input",{_invalid:!c.teamName}]),placeholder:"Название","onUpdate:modelValue":a[4]||(a[4]=e=>u.value.teamName=e),required:!i.value,onBlur:a[5]||(a[5]=e=>d("teamName"))},null,42,J),[[s.Jo,u.value.teamName]])])),(0,l.Lk)("div",z,[a[16]||(a[16]=(0,l.Lk)("label",{for:"first-name",class:"label-title"},"Имя:",-1)),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"first-name",class:(0,n.C4)(["default-input",{_invalid:!c.name}]),placeholder:"Имя","onUpdate:modelValue":a[6]||(a[6]=e=>u.value.name=e),required:"",onBlur:a[7]||(a[7]=e=>d("name"))},null,34),[[s.Jo,u.value.name]])]),(0,l.Lk)("div",Y,[a[17]||(a[17]=(0,l.Lk)("label",{for:"last-name",class:"label-title"},"Фамилия:",-1)),(0,l.bo)((0,l.Lk)("input",{type:"text",id:"last-name",class:(0,n.C4)(["default-input",{_invalid:!c.lastName}]),placeholder:"Фамилия капитана","onUpdate:modelValue":a[8]||(a[8]=e=>u.value.lastName=e),required:"",onBlur:a[9]||(a[9]=e=>d("lastName"))},null,34),[[s.Jo,u.value.lastName]])]),(0,l.Lk)("div",H,[a[18]||(a[18]=(0,l.Lk)("label",{for:"birth-date",class:"label-title"},"Дата рождения:",-1)),(0,l.bo)((0,l.Lk)("input",{type:"date",id:"birth-date",class:(0,n.C4)(["default-input",{_invalid:!c.dateBorn}]),"onUpdate:modelValue":a[10]||(a[10]=e=>u.value.dateBorn=e),required:"",onBlur:a[11]||(a[11]=e=>d("dateBorn"))},null,34),[[s.Jo,u.value.dateBorn]])])]),(0,l.Lk)("button",{class:"big-btn _active w-100",onClick:m,disabled:v.value}," Регистрация ",8,Z)],32))}});const ae=(0,c.A)(ee,[["__scopeId","data-v-6d335676"]]);var te=ae,se=t(1387);const le={key:0,class:"event-selection"},ne={class:"event-selection__container"};var oe=(0,l.pM)({__name:"eventSelection",setup(e){const a=(0,r.Pj)(),t=((0,l.EW)((()=>a.state.groups)),(0,l.EW)((()=>a.state.parsedEvents))),n=(0,se.lq)(),u=(0,l.EW)((()=>+n.query.eventId)),i=(0,l.EW)((()=>{if(t.value){const e=t.value.find((e=>e.id===u.value));return a.commit("setSelectedEvent",e),e}return null})),c=((0,o.KR)(0),(0,l.EW)((()=>a.state.steps.stepsFields))),d=(0,l.EW)((()=>!1===c.value.isAlone)),p=(0,l.EW)((()=>!0===c.value.isAlone||!!c.value.yachtType?.id)),v=(0,l.EW)((()=>c.value.selectedStages?.length>0)),f=(0,l.EW)((()=>"boolean"===typeof c.value.instructor));return(e,a)=>i.value?((0,l.uX)(),(0,l.CE)("div",le,[(0,l.bF)(m,{class:"event-selection__step"}),(0,l.Lk)("div",ne,[(0,l.bF)(s.eB,{name:"fade"},{default:(0,l.k6)((()=>[d.value?((0,l.uX)(),(0,l.Wv)(w,{key:0,class:"event-selection__step"})):(0,l.Q3)("",!0)])),_:1}),(0,l.bF)(s.eB,{name:"fade"},{default:(0,l.k6)((()=>[p.value?((0,l.uX)(),(0,l.Wv)(j,{key:0,class:"event-selection__step"})):(0,l.Q3)("",!0)])),_:1}),(0,l.bF)(s.eB,{name:"fade"},{default:(0,l.k6)((()=>[v.value?((0,l.uX)(),(0,l.Wv)(Q,{key:0,class:"event-selection__step"})):(0,l.Q3)("",!0)])),_:1}),(0,l.bF)(s.eB,{name:"fade"},{default:(0,l.k6)((()=>[f.value?((0,l.uX)(),(0,l.Wv)(te,{key:0,class:"event-selection__step"})):(0,l.Q3)("",!0)])),_:1})])])):(0,l.Q3)("",!0)}});const re=(0,c.A)(oe,[["__scopeId","data-v-0306c6ef"]]);var ue=re;const ie={class:"final-success"},ce={class:"row-table"},de={class:"row-table"},me={class:"row-table"},pe={class:"row-table"},ve={class:"row-table"},fe=["innerHTML"],be={class:"row-table"},he={key:0,class:"row-table"},_e={class:"row-table"},ke={class:"row-table"},ye={class:"row-table"};var ge=(0,l.pM)({__name:"finalSuccess",setup(e){const a=(0,r.Pj)(),t=(0,l.EW)((()=>a.state.steps.stepsFields)),s=((0,l.EW)((()=>a.state.steps.memberForm)),(0,l.EW)((()=>a.state.steps.dealData))),o=(0,l.EW)((()=>{let e=s.value.stages;return e.replace(/,/g,"<br>")}));return(e,a)=>((0,l.uX)(),(0,l.CE)("div",ie,[a[10]||(a[10]=(0,l.Lk)("h2",{class:"tit-h2"},"Поздравляем, вы успешно зарегистрировались",-1)),a[11]||(a[11]=(0,l.Lk)("br",null,null,-1)),a[12]||(a[12]=(0,l.Lk)("div",{class:"label-title"},"Данные:",-1)),(0,l.Lk)("p",ce,[a[0]||(a[0]=(0,l.Lk)("span",null,"Событие:",-1)),(0,l.Lk)("span",null,(0,n.v_)(s.value.dealName),1)]),(0,l.Lk)("p",de,[a[1]||(a[1]=(0,l.Lk)("span",null,"Тип регистрации:",-1)),(0,l.Lk)("span",null,(0,n.v_)(t.value.isAlone?"В сборный экипаж":"Своя команда"),1)]),(0,l.Lk)("p",me,[a[2]||(a[2]=(0,l.Lk)("span",null,"Тип яхты:",-1)),(0,l.Lk)("span",null,(0,n.v_)(t.value.yachtType?t.value.yachtType.btnText:"Нет"),1)]),(0,l.Lk)("div",pe,[a[3]||(a[3]=(0,l.Lk)("span",null,"Интструктор:",-1)),(0,l.Lk)("span",null,(0,n.v_)(s.value.isNeedInstructor),1)]),(0,l.Lk)("div",ve,[a[4]||(a[4]=(0,l.Lk)("span",null,"Этапы:",-1)),(0,l.Lk)("span",{innerHTML:o.value},null,8,fe)]),(0,l.Lk)("p",be,[a[5]||(a[5]=(0,l.Lk)("span",null,"Номер телефона:",-1)),(0,l.Lk)("span",null,"+"+(0,n.v_)(s.value.phoneNumber),1)]),"нет"!==s.value.nameOfTeam?((0,l.uX)(),(0,l.CE)("p",he,[a[6]||(a[6]=(0,l.Lk)("span",null,"Название команды:",-1)),(0,l.Lk)("span",null,(0,n.v_)(s.value.nameOfTeam),1)])):(0,l.Q3)("",!0),(0,l.Lk)("p",_e,[a[7]||(a[7]=(0,l.Lk)("span",null,"Имя:",-1)),(0,l.Lk)("span",null,(0,n.v_)(s.value.name),1)]),(0,l.Lk)("p",ke,[a[8]||(a[8]=(0,l.Lk)("span",null,"Фамилия:",-1)),(0,l.Lk)("span",null,(0,n.v_)(s.value.lastName),1)]),(0,l.Lk)("p",ye,[a[9]||(a[9]=(0,l.Lk)("span",null,"Дата рождения:",-1)),(0,l.Lk)("span",null,(0,n.v_)(s.value.dateOfBorn),1)])]))}});const Le=ge;var Ee=Le;const Te={class:"final-modal"};var we=(0,l.pM)({__name:"finalModal",setup(e){(0,r.Pj)();return(e,a)=>((0,l.uX)(),(0,l.CE)("div",Te,[(0,l.bF)(Ee)]))}});const Fe=we;var Oe=Fe;const We={class:"loader"},Ce={class:"content"},Ve={class:"label-title"};var Ne=(0,l.pM)({__name:"App",setup(e){const a=(0,r.Pj)(),t=(0,l.EW)((()=>a.state.mainLoader));(0,o.KR)(!1),(0,o.KR)(!1);return(0,l.sV)((()=>{a.dispatch("getAllGroups")})),(e,r)=>((0,l.uX)(),(0,l.CE)("div",{class:(0,n.C4)(["container",{"main-loading":t.value}])},[(0,l.bo)((0,l.Lk)("div",We,null,512),[[s.aG,t.value]]),(0,l.Lk)("div",Ce,[(0,l.Lk)("p",Ve,"Версия формы "+(0,n.v_)((0,o.R1)(a).state.version),1),(0,l.bo)((0,l.bF)(ue,null,null,512),[[s.aG,!(0,o.R1)(a).state.steps.allOrdersCreated]]),(0,o.R1)(a).state.steps.allOrdersCreated?((0,l.uX)(),(0,l.Wv)(Oe,{key:0})):(0,l.Q3)("",!0)])],2))}});const Se=Ne;var xe=Se;const Ae=[],Be=(0,se.aE)({history:(0,se.LA)("/"),routes:Ae});var $e=Be,Ie=t(4373);t(1701),t(3579),t(7642),t(8004),t(3853),t(5876),t(2475),t(5024),t(1698);function Xe(e){const a={};e.forEach((e=>{const t=je(e.service.category.title);if(t){const{categoryId:s,name:l,type:n}=t;a[s]||(a[s]={id:s,name:l,newTeam:{},existingTeam:[]});const o=Pe(e.service.title);if(o){const{stageNumber:t,stageName:l}=o,r=e.staff.position.title;n.toLowerCase().includes("у меня команда")&&(a[s].newTeam[r]||(a[s].newTeam[r]=[]),Me(a[s].newTeam[r],t,l,e)),n.toLowerCase().includes("я один")&&Me(a[s].existingTeam,t,l,e)}}})),Object.values(a).forEach((e=>{["newTeam","existingTeam"].forEach((a=>{const t=e[a];"newTeam"===a?Object.keys(t).forEach((e=>{const a=t[e];Array.isArray(a)&&De(a)})):De(t)}))}));const t=Object.values(a),s=Ue(e);return{parsedEvents:t,staffsPositions:s}}function je(e){const a=e.match(/^\[(\d+)\] (.+) \/ (.+)$/);if(a){const[,e,t,s]=a;return{categoryId:parseInt(e,10),name:t,type:s}}return null}function Pe(e){const a=e.match(/^(\d+)/);return a?{stageNumber:parseInt(a[1],10),stageName:e}:null}function Me(e,a,t,s){let l=e.find((e=>e.number===a));l||(l={number:a,name:t,name2:null,services:[],services2:[]},e.push(l));const n=t.match(/ДЕНЬ (\d+)$/);n&&"2"===n[1]?(l.name2=t,l.services2.push(s)):l.services.push(s)}function De(e){for(let a=1;a<=4;a++)e.some((e=>e.number===a))||e.push({number:a,name:`${a} ЭТАП`,name2:null,services:[],services2:[]})}function Ue(e){const a=e.map((e=>e.staff.position.title));return Array.from(new Set(a)).map((e=>{const a=e.match(/\(([^)]+)\)/),t=a?a[1]:"",s=Math.floor(1e6*Math.random());return{position:e,btnText:t,id:s}}))}var Re=Xe;function Qe(e){let a="";return e.forEach((e=>{a+=`${e.name}(${x(e.services[0].date)}), `,e.name2&&(a+=`${e.name2}(${x(e.services2[0].date)}), `)})),a}function qe(e){let a=0;return e.forEach((e=>{a+=e.services[0].service.price_max,e.name2&&(a+=e.services2[0].service.price_max)})),a}function Ge(e){let a="";return e.forEach((e=>{a+=`${e.name}(${e.services[0].service.price_max.toLocaleString()}₽), `,e.name2&&(a+=`${e.name2}(${e.services2[0].service.price_max.toLocaleString()}₽), `)})),a}function Ke(e){const[a,t,s]=e.split("-");return`${s}.${t}.${a}`}var Je={state:{allOrdersCreated:!1,createdOrdersLoading:!1,stepsFields:{isAlone:null,yachtType:null,selectedStages:[],instructor:null,comment:""},memberForm:{email:"",phone:"",teamName:"",name:"",lastName:"",dateBorn:""},orderData:{comment:"",email:"",fullname:"",surname:"",phone:"",clients_count:1,is_charge_required_priority:!0,is_newsletter_allowed:!0,is_personal_data_processing_allowed:!0,is_support_charge:!0},dealData:{dealName:"",typeOfReg:"",typeOfYacht:"",stages:"",isNeedInstructor:"",price:"",priceList:"",email:"",phoneNumber:"",nameOfTeam:"",name:"",lastName:"",dateOfBorn:""}},getters:{},mutations:{fillOrderData(e){const a=e.memberForm,t=e.stepsFields,s=t.instructor?`Инструктор нужен, комментарий: ${t.comment}`:"Инструктор не нужен";e.orderData={comment:s,email:a.email,fullname:a.name,surname:a.lastName,phone:a.phone,is_personal_data_processing_allowed:!0,clients_count:1,is_charge_required_priority:!0,is_newsletter_allowed:!0,is_support_charge:!0}},fillDealData(e,a){const t=e.memberForm,s=e.stepsFields,l=s.instructor?`Инструктор нужен, комментарий: ${s.comment}`:"Инструктор не нужен";e.dealData={dealName:a.selectedEvent.name,typeOfReg:s.isAlone?"Я один":"У меня команда",typeOfYacht:s.yachtType?.position||"нет",stages:Qe(s.selectedStages),isNeedInstructor:l,price:qe(s.selectedStages),priceList:Ge(s.selectedStages),email:t.email,phoneNumber:t.phone,nameOfTeam:t.teamName?t.teamName:"Нет",name:t.name,lastName:t.lastName,dateOfBorn:Ke(t.dateBorn)}}},actions:{createOrders(e){e.state.createdOrdersLoading=!0;const a=e.state.stepsFields.selectedStages;e.state.stepsFields.selectedStages.sort(((e,a)=>e.number-a.number)),e.commit("fillOrderData"),e.commit("fillDealData",e.rootState),e.dispatch("getAllGroups",null,{root:!0}).then((()=>{const t=[];a.forEach((e=>{const a=e.services.find((e=>e.records_count<e.capacity)),s=e.services2.find((e=>e.records_count<e.capacity));a&&t.push(a.id),s&&t.push(s.id)})),console.log(t);const s=t.map(((a,t)=>new Promise((s=>{setTimeout((()=>{e.dispatch("createOrder",a),s()}),200*t)}))));Promise.all(s).finally((()=>{console.log("Все заказы созданы"),e.state.allOrdersCreated=!0,e.state.createdOrdersLoading=!1}))}))},async createOrder(e,a){return await(0,Ie.A)({url:`https://api.yclients.com/api/v1/activity/${e.rootState.salonId}/${a}/book`,method:"POST",data:e.state.orderData,headers:{Authorization:e.rootState.auth}})}}},ze=(0,r.y$)({state:{version:"1.0",auth:"Bearer gtcwf654agufy25gsadh",salonId:1268324,mainLoader:!0,groups:[],parsedEvents:null,staffsPositions:[],selectedEvent:null},getters:{},mutations:{parseGroupsArray(e,a){e.groups=a;const{parsedEvents:t,staffsPositions:s}=Re(a);e.parsedEvents=t,e.staffsPositions=s,e.mainLoader=!1},setSelectedEvent(e,a){e.selectedEvent=a}},actions:{async getAllGroups(e){return await(0,Ie.A)({method:"GET",url:`https://api.yclients.com/api/v1/activity/${e.state.salonId}/search?count=1000&from=2025-02-31&till=9999-01-01`,headers:{Authorization:e.state.auth}}).then((a=>{e.commit("parseGroupsArray",a.data.data)}))}},modules:{steps:Je}});(0,s.Ef)(xe).use(ze).use($e).mount("#app")}},a={};function t(s){var l=a[s];if(void 0!==l)return l.exports;var n=a[s]={exports:{}};return e[s].call(n.exports,n,n.exports,t),n.exports}t.m=e,function(){var e=[];t.O=function(a,s,l,n){if(!s){var o=1/0;for(c=0;c<e.length;c++){s=e[c][0],l=e[c][1],n=e[c][2];for(var r=!0,u=0;u<s.length;u++)(!1&n||o>=n)&&Object.keys(t.O).every((function(e){return t.O[e](s[u])}))?s.splice(u--,1):(r=!1,n<o&&(o=n));if(r){e.splice(c--,1);var i=l();void 0!==i&&(a=i)}}return a}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[s,l,n]}}(),function(){t.n=function(e){var a=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(a,{a:a}),a}}(),function(){t.d=function(e,a){for(var s in a)t.o(a,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:a[s]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};t.O.j=function(a){return 0===e[a]};var a=function(a,s){var l,n,o=s[0],r=s[1],u=s[2],i=0;if(o.some((function(a){return 0!==e[a]}))){for(l in r)t.o(r,l)&&(t.m[l]=r[l]);if(u)var c=u(t)}for(a&&a(s);i<o.length;i++)n=o[i],t.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return t.O(c)},s=self["webpackChunkzigzag"]=self["webpackChunkzigzag"]||[];s.forEach(a.bind(null,0)),s.push=a.bind(null,s.push.bind(s))}();var s=t.O(void 0,[504],(function(){return t(4094)}));s=t.O(s)})();
//# sourceMappingURL=app.0ea92df6.js.map